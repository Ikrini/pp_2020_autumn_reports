\documentclass{report}
\usepackage{tikz}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{luainputenc}
\usepackage[english, russian]{babel}
\usepackage[pdftex]{hyperref}
\usepackage[14pt]{extsizes}
\usepackage{listings}
\usepackage{color}
\usepackage{geometry}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{graphicx}
\usepackage{indentfirst}

\geometry{a4paper,top=2cm,bottom=3cm,left=2cm,right=1.5cm}
\setlength{\parskip}{0.5cm}
\setlist{nolistsep, itemsep=0.3cm,parsep=0pt}

\lstset{language=C++,
		basicstyle=\footnotesize,
		keywordstyle=\color{blue}\ttfamily,
		stringstyle=\color{red}\ttfamily,
		commentstyle=\color{green}\ttfamily,
		morecomment=[l][\color{magenta}]{\#}, 
		tabsize=4,
		breaklines=true,
  		breakatwhitespace=true,
  		title=\lstname,       
}

\makeatletter
\renewcommand\@biblabel[1]{#1.\hfil}
\makeatother

\begin{document}

\begin{titlepage}

\begin{center}
–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –Ω–∞—É–∫–∏ –∏ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏
\end{center}

\begin{center}
–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–µ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏–µ –≤—ã—Å—à–µ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è \\
–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç –∏–º. –ù.–ò. –õ–æ–±–∞—á–µ–≤—Å–∫–æ–≥–æ
\end{center}

\begin{center}
–ò–Ω—Å—Ç–∏—Ç—É—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∏ –º–µ—Ö–∞–Ω–∏–∫–∏
\end{center}

\vspace{4em}

\begin{center}
\textbf{\Large–û—Ç—á–µ—Ç –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ} \\
\end{center}
\begin{center}
\textbf{\Large¬´–£–º–Ω–æ–∂–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü. –≠–ª–µ–º–µ–Ω—Ç—ã —Ç–∏–ø–∞ double. –ë–ª–æ—á–Ω–∞—è —Å—Ö–µ–º–∞, –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞.¬ª} \\
\end{center}

\vspace{4em}

\newbox{\lbox}
\savebox{\lbox}{\hbox{text}}
\newlength{\maxl}
\setlength{\maxl}{\wd\lbox}
\hfill\parbox{7cm}{
\hspace*{5cm}\hspace*{-5cm}\textbf{–í—ã–ø–æ–ª–Ω–∏–ª:} \\ —Å—Ç—É–¥–µ–Ω—Ç –≥—Ä—É–ø–ø—ã 381806-4 \\ –ò–∫—Ä–æ–º–æ–≤ –ò. –ò.\\
\\
\hspace*{5cm}\hspace*{-5cm}\textbf{–ü—Ä–æ–≤–µ—Ä–∏–ª:}\\ –¥–æ—Ü–µ–Ω—Ç –∫–∞—Ñ–µ–¥—Ä—ã –ú–û–°–¢, \\ –∫–∞–Ω–¥–∏–¥–∞—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –Ω–∞—É–∫ \\ –°—ã—Å–æ–µ–≤ –ê. –í.\\
}
\vspace{\fill}

\begin{center} –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ \\ 2020 \end{center}

\end{titlepage}

\setcounter{page}{2}

% –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
\tableofcontents
\newpage



% –í–≤–µ–¥–µ–Ω–∏–µ
\section*{–í–≤–µ–¥–µ–Ω–∏–µ}
\addcontentsline{toc}{section}{–í–≤–µ–¥–µ–Ω–∏–µ}
–ú–∞—Ç—Ä–∏—á–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –≤ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö
–≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö. –û–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º
 \begin{equation}\label{key}
	C_{ij} = \sum_{k=0}^{n-1} a_{i,k} \times\ b_{k,j} , \quad 0 \leq i,j < n
\end{equation}
\par –ù–µ—Ç—Ä—É–¥–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü —Ç—Ä–µ–±—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
–æ–ø–µ—Ä–∞—Ü–∏–π - \begin{math} n^{3} \end{math} —Å–∫–∞–ª—è—Ä–Ω—ã—Ö —É–º–Ω–æ–∂–µ–Ω–∏–π –∏ —Å–ª–æ–∂–µ–Ω–∏–π. –ß—Ç–æ –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Å–∏–ª—å–Ω–æ —Å–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞
—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –¥–∞–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é. –í—Å—Ç–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å
—Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
\par –ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–∞—Ä—è–¥—É —Å
—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ–º –º–∞—Ç—Ä–∏—Ü –≤ –≤–∏–¥–µ –Ω–∞–±–æ—Ä–æ–≤ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–æ—á–Ω–æ–µ
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü. –ü—Ä–∏ —Ç–∞–∫–æ–º –ø–æ–¥—Ö–æ–¥–µ –º–∞—Ç—Ä–∏—Ü—ã-–æ–ø–µ—Ä–∞–Ω–¥—ã A, B –∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è
–º–∞—Ç—Ä–∏—Ü–∞ C —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ –Ω–∞–±–æ—Ä –±–ª–æ–∫–æ–≤.
\par –†–∞–∑–±–∏–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü –Ω–∞ –±–ª–æ–∫–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ø—Ä–æ—â–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –≤—ã–±–æ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö
—Å–ø–æ—Å–æ–±–æ–≤ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
\par –û–¥–Ω–∏–º –∏–∑ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π –±–ª–æ—á–Ω–æ–µ
—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —è–≤–ª—è–µ—Ç—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞. –û–Ω –∏ –±—É–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ
—Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω –≤ –Ω–∞—Å—Ç–æ—è—â–µ–π —Ä–∞–±–æ—Ç–µ.
\par –¶–µ–ª—å –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Äì —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è -
–∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞, –∏ —Å—Ä–∞–≤–Ω–∏—Ç—å –µ–≥–æ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º


% –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏
\section*{–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏}
\addcontentsline{toc}{section}{–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏}
–î–∞–Ω—ã –¥–≤–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã A –∏ B —Ä–∞–∑–º–µ—Ä–∞ n √ó n. –≠–ª–µ–º–µ–Ω—Ç—ã –º–∞—Ç—Ä–∏—Ü ‚Äì –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ
—á–∏—Å–ª–∞ —Ç–∏–ø–∞ . –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü A –∏ B —è–≤–ª—è–µ—Ç—Å—è –º–∞—Ç—Ä–∏—Ü–∞ C —Ä–∞–∑–º–µ—Ä–∞ n √ó n,
–∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –∫–æ—Ç–æ—Ä–æ–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º (1)
\par –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–º–Ω–æ–∂–∏—Ç—å –º–∞—Ç—Ä–∏—Ü—ã A –∏ B –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–≤ P –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —É–∑–ª–æ–≤. –í
–∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞ –ø—Ä–∏ –±–ª–æ—á–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

\par –°—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ —á–∏—Å–ª–æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —É–ª–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–æ–º –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ
–Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ p –∏ —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –∫—Ä–∞—Ç–µ–Ω —ç—Ç–æ–º—É —á–∏—Å–ª—É:
\begin{equation} P = p^{2}, \quad p \in N \quad \end{equation}
\begin{equation} \frac{n}{p} = z, \quad z \in N  \end{equation}
 \par –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ MPI. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google C++ Testing Framework.
\newpage

% –ú–µ—Ç–æ–¥ —Ä–µ—à–µ–Ω–∏—è
\section*{–ú–µ—Ç–æ–¥ —Ä–µ—à–µ–Ω–∏—è}
\addcontentsline{toc}{section}{–ú–µ—Ç–æ–¥ —Ä–µ—à–µ–Ω–∏—è}
–í –∞–ª–≥–æ—Ä–∏—Ç–º–µ –§–æ–∫—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–æ—á–Ω–∞—è —Å—Ö–µ–º–∞ —Ä–∞–∑–±–∏–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü - –∏—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
–ê, –í –∏ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –° –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –≤–∏–¥–µ –Ω–∞–±–æ—Ä–æ–≤ –±–ª–æ–∫–æ–≤. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤
–ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ –∏ —Ä–∞–≤–Ω–æ q (—Ç.–µ. —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –±–ª–æ–∫–æ–≤ —Ä–∞–≤–µ–Ω k √ó k, k = n/q). 
\par –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–æ–∫—Å–∞ –≤–∫–ª—é—á–∞–µ—Ç: 
\\1. –≠—Ç–∞–ø –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
\\2. –≠—Ç–∞–ø –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
\\ –ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ \[I: 0 \leq I < q\] –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:
\par \\2.1.1. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ \[i: 0 \leq i < q\] –±–ª–æ–∫ \begin{math} A_{i,j} \end{math} –ø–æ–¥–∑–∞–¥–∞—á–∏ (i,j) –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –≤—Å–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ —Ç–æ–π –∂–µ —Å—Ç—Ä–æ–∫–∏ i —Ä–µ—à–µ—Ç–∫–∏. –ò–Ω–¥–µ–∫—Å j,–æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –≤ —Å—Ç—Ä–æ–∫–µ, –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º
\begin{equation} j = (i + I) mod \, q \end{equation}
–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ—Å—ã–ª–æ–∫ –±–ª–æ–∫–∏ \begin{math}A'_{i,j}, B'_{i,j} \end{math} –∫–∞–∂–¥–æ–π –ø–æ–¥–∑–∞–¥–∞—á–∏ (i,j) –ø–µ—Ä–µ–º–Ω–æ–∂–∞—é—Ç—Å—è –∏ –ø—Ä–∏–±–∞–≤–ª—è—é—Ç—Å—è –∫ –±–ª–æ–∫—É C_{i,j}.\end{math}
\par \\2.2.2. –ë–ª–æ–∫–∏ \begin{math}B'_{i,j} \end{math}–∫–∞–∂–¥–æ–π –ø–æ–¥–∑–∞–¥–∞—á–∏ (i,j) –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –ø–æ–¥–∑–∞–¥–∞—á–∞–º, —è–≤–ª—è—é—â–∏–º—Å—è —Å–æ—Å–µ–¥—è–º–∏ —Å–≤–µ—Ä—Ö—É –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö —Ä–µ—à–µ—Ç–∫–∏ –ø–æ–¥–∑–∞–¥–∞—á (–±–ª–æ–∫–∏ –ø–æ–¥–∑–∞–¥–∞—á –∏–∑ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ—à–µ—Ç–∫–∏ –ø–µ—Ä–µ—Å—ã–ª–∞—é—Ç—Å—è –ø–æ–¥–∑–∞–¥–∞—á–∞–º –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ—à–µ—Ç–∫–∏).
\newpage

% –°—Ö–µ–º–∞ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è
\section*{–°—Ö–µ–º–∞ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è}
\addcontentsline{toc}{section}{–°—Ö–µ–º–∞ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞–Ω–∏—è}
–î–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
–∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–æ–∫—Å–∞. 
\par 1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.
\par \\ –î–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–æ–∫—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –±–∞–∑–æ–≤—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –≤–∏–¥–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ q √ó q, –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–º–µ—é—â–∏—Ö—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ùëÉ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –≤–∏–¥–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ p √ó p, —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ.
\par \\ –¢–∞–∫ –∫–∞–∫ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω—ã–º –∫–≤–∞–¥—Ä–∞—Ç–æ–º, –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –≤ –º–∞—Ç—Ä–∏—Ü–∞—Ö –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ —Ä–∞–≤–Ω—ã–º p (—Ç.–µ. q = p). –¢–∞–∫–æ–π —Å–ø–æ—Å–æ–± –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –±–ª–æ–∫–æ–≤ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –æ–±—ä–µ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–π –ø–æ–¥–∑–∞–¥–∞—á–µ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏ —Ç–µ–º —Å–∞–º—ã–º –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.
\par \\ –ò—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ø–æ–ª–æ–≥–∏—é –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ –≤–∏–¥–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏
—Ä–∞–∑–º–µ—Ä–∞ p √ó p, –ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –ø–æ–¥–∑–∞–¥–∞—á –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤:
–±–∞–∑–æ–≤–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ (i,j) —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–µ P_{i,j}.

\par 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö.
\par \\ –í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –§–æ–∫—Å–∞, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ –≤
–∫–∞–∂–¥—ã–π —Ç–µ–∫—É—â–∏–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –∫–∞–∂–¥–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ (i,j) —Å–æ–¥–µ—Ä–∂–∞—Ç –ª–∏—à—å —á–∞—Å—Ç—å
–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –∞ –¥–æ—Å—Ç—É–ø –∫ –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤
—Ö–æ–¥–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –∫–∞–∂–¥–æ–π –±–∞–∑–æ–≤–æ–π –ø–æ–¥–∑–∞–¥–∞—á–µ (i,j) —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á–µ—Ç—ã—Ä–µ –º–∞—Ç—Ä–∏—á–Ω—ã—Ö
–±–ª–æ–∫–∞:
\par \\ - \quad  –ë–ª–æ–∫ \begin{math}C_{a,j} \end{math} –º–∞—Ç—Ä–∏—Ü—ã C, –≤—ã—á–∏—Å–ª—è–µ–º—ã–π –ø–æ–¥–∑–∞–¥–∞—á–µ–π.
\par \\ - \quad  –ë–ª–æ–∫ \begin{math}A_{i,j} \end{math} –º–∞—Ç—Ä–∏—Ü—ã A, —Ä–∞–∑–º–µ—â–∞–µ–º—ã–π –≤ –ø–æ–¥–∑–∞–¥–∞—á–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
\par \\ - \quad –ë–ª–æ–∫–∏  \begin{math}A'_{i.j}, \, B'{i,j} \end{math} –º–∞—Ç—Ä–∏—Ü A –∏ B, –ø–æ–ª—É—á–∞–µ–º—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–µ–π –≤ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
 
\newpage

% –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
\section*{–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏}
\addcontentsline{toc}{section}{–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏}
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø–æ–¥—Ä–æ–±–Ω–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ
–∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–æ–∫—Å–∞.
\par –û–ø–∏—Å–∞–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
\par \quad  -> int procNum - —á–∏—Å–ª–æ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —É–∑–ª–æ–≤;
\par \quad -> int cartSize - —Ä–∞–∑–º–µ—Ä —Ä–µ—à–µ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤;
\par \quad -> int blockSize - —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—á–Ω—ã—Ö –±–ª–æ–∫–æ–≤;
\par \quad -> int rank - —Ä–∞–Ω–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞;
\par \quad -> int coords[2] - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —Ä–µ—à–µ—Ç–∫–µ;
\par \quad -> MPI_Comm _ comm _ cart - grid switch;
\par \quad -> MPI_Comm _ comm _ row - string communicators;
\par \quad -> MPI_Comm_comm_col - column communicators;

\par –û–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:

\begin{lstlisting}
void Topology()
\end{lstlisting}
—Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä –≤ –≤–∏–¥–µ –¥–≤—É–º–µ—Ä–Ω–æ–π –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏
(–∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏—é MPI_Cart_create), –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ —ç—Ç–æ–π —Ä–µ—à–µ—Ç–∫–µ (MPI_Cart_coords), –∞ —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞–µ—Ç –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä—ã –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –∫–∞–∂–¥–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ —Ä–µ—à–µ—Ç–∫–∏(MPI_Cart_sub).
\begin{lstlisting}
void Scatter(double* Matrix, double* block, int size)
\end{lstlisting}
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –±–ª–æ—á–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã Matrix —Ä–∞–∑–º–µ—Ä–∞ size √ó size –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –≤ –¥–≤—É–º–µ—Ä–Ω—É—é –∫–≤–∞–¥—Ä–∞—Ç–Ω—É—é —Ä–µ—à–µ—Ç–∫—É. –î–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å—ã–ª–∞—é—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞. –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –º–∞—Ç—Ä–∏—Ü–∞ Matrix, –Ω–∞—Ö–æ–¥—è—â–∞—è—Å—è –≤ ¬´–∫–æ—Ä–Ω–µ–≤–æ–º¬ª –ø—Ä–æ—Ü–µ—Å—Å–µ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (0,0), —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª–æ—Å—ã. –≠—Ç–∏ –ø–æ–ª–æ—Å—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ –Ω—É–ª–µ–≤–æ–π —Å—Ç–æ–ª–±–µ—Ü —Ä–µ—à–µ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (MPI_Scatter –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä–∞ –Ω—É–ª–µ–≤–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞). –î–∞–ª–µ–µ –∫–∞–∂–¥–∞—è –ø–æ–ª–æ—Å–∞ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –±–ª–æ–∫–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–º–∏ —Å—Ç—Ä–æ–∫–∏ —Ä–µ—à–µ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (MPI_Scatter –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä–∞ —Å—Ç—Ä–æ–∫). –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –Ω–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –±–ª–æ–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –±—É—Ñ–µ—Ä block. –í –ø—Ä–æ–≥—Ä–∞–º–º–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü–æ–ø–µ—Ä–∞–Ω–¥–æ–≤ ùê¥ –∏ ùêµ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏.
\begin{lstlisting}
void ABlockTransfer(int it, double* Ablock, double* AMatrixblock) 
\end{lstlisting}
–≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞—Å—Å—ã–ª–∫—É –±–ª–æ–∫–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã A –ø–æ —Å—Ç—Ä–æ–∫–∞–º —Ä–µ—à–µ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ –±—É—Ñ–µ—Ä –ø—Ä–∏–µ–º–∞ Ablock. –î–ª—è —ç—Ç–æ–≥–æ –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ —Ä–µ—à–µ—Ç–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤–µ–¥—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å, –æ—Å—É—â–µ—Å—Ç–≤–ª—è—é—â–∏–π —Ä–∞—Å—Å—ã–ª–∫—É. –î–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–æ–∫ AMatrixblock, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ –ø—Ä–æ—Ü–µ—Å—Å –≤ –º–æ–º–µ–Ω—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞—Å—Å—ã–ª–∫–∏ –±–ª–æ–∫–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ MPI_Bcast. –°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π –∏ –µ–µ 8 –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–¥–µ–ª–∞–º–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫ —Ä–µ—à–µ—Ç–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
–∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä–æ–≤ comm_row, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–ª—è –Ω–∞–±–æ—Ä–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ä–µ—à–µ—Ç–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏.
\begin{lstlisting}
void BlockMultiplication(double* Ablock, double* Bblock, double* Cblock, int _BlockSize)
\end{lstlisting}
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ Ablock –∏ Bblock, —Ä–∞–∑–º–µ—Ä–∞–º–∏ _BlockSize –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–æ—Ä–º—É–ª–æ–π (1). –†–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ Cblock.
\begin{lstlisting}
void BblockTransfer(double* Bblock) 
\end{lstlisting}
–≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –±–ª–æ–∫–æ–≤ –º–∞—Ç—Ä–∏—Ü—ã ùêµ–ø–æ —Å—Ç–æ–ª–±—Ü–∞–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏ –≤–≤–µ—Ä—Ö. –ö–∞–∂–¥—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–¥–∞–µ—Ç —Å–≤–æ–π –±–ª–æ–∫ —Å–ª–µ–¥—É—é—â–µ–º—É–ø—Ä–æ—Ü–µ—Å—Å—É, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–º—É –≤—ã—à–µ –≤ —Å—Ç–æ–ª–±—Ü–µ —Ä–µ—à–µ—Ç–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, –∏ –ø–æ–ª—É—á–∞–µ—Ç –±–ª–æ–∫, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –Ω–∏–∂–µ. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è–ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ MPI_SendRecv_replace, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ–ø–µ—Ä–µ—Å—ã–ª–∫–∏ –±–ª–æ–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏ —ç—Ç–æ–º –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –±—É—Ñ–µ—Ä –ø–∞–º—è—Ç–∏ Bblock.
\begin{lstlisting}
void FoxAlg(double* Ablock, double* AMatrixblock, double* Bblock, double* Cblock)
\end{lstlisting}
—Ä–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –§–æ–∫—Å–∞, –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤ –≥–ª–∞–≤–µ ¬´–ú–µ—Ç–æ–¥—ã —Ä–µ—à–µ–Ω–∏—è¬ª: –í —Ü–∏–∫–ª–µ –æ—Ç 0 –¥–æ GridSize –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–∞—Å—Å—ã–ª–∫–∞ –±–ª–æ–∫–æ–≤ AMatrixblock, –ø–æ —Å—Ç—Ä–æ–∫–∞–º –ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏ –≤ –±—É—Ñ–µ—Ä—ã Ablock (—Ñ—É–Ω–∫—Ü–∏—è ABlockTransfer), –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É–º–Ω–æ–∂–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ (BlockMultiplication). –†–µ–∑—É–ª—å—Ç–∞—Ç —É–º–Ω–æ–∂–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ Cblock. –ü–æ—Å–ª–µ —á–µ–≥–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥ –±–ª–æ–∫–æ–≤ Bblock –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–π —Ä–µ—à–µ—Ç–∫–∏ (BblockTransfer).

\begin{lstlisting}
void ImportResult(double* C, double* Cblock, intsize)
\end{lstlisting}
–æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π –º–∞—Ç—Ä–∏—Ü—ã ùê∂ —Ä–∞–∑–º–µ—Ä–∞ ùë†ùëñùëßùëí √ó ùë†ùëñùëßùëí –∏–∑ –±–ª–æ–∫–æ–≤ Cblock. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–∞–∫–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ –¥–≤—É—Ö—ç—Ç–∞–ø–Ω–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã, –∑–µ—Ä–∫–∞–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–µ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü—ã Scatter.
\begin{lstlisting}
void Fox(double* A, double* B, double* C, int size)
\end{lstlisting}
–≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –∞–ª–≥–æ—Ä–∏—Ç–º–∞, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º—ã, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤—ã—à–µ. –í –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Ç—Ä–∏—Ü—ã A –∏ B —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ —É–º–Ω–æ–∂–µ–Ω–∏–∏, –º–∞—Ç—Ä–∏—Ü—É C –¥–ª—è –∑–∞–ø–∏—Å–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –∏—Ö —Ä–∞–∑–º–µ—Ä .
\newpage

% –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
\section*{–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏}
\addcontentsline{toc}{section}{–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏}
–î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Google C++ Testing Framework.
\par –ù–∞–±–æ—Ä –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–∑ —Å–µ–±—è —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–≤–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å, –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä), –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (—Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –±–ª–∞–≥–æ–¥–∞—Ä—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –∏–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–µ –≤–µ–∫—Ç–æ—Ä —Å –≤–µ–∫—Ç–æ—Ä–æ–º, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏–∑ STL –±–∏–±–ª–∏–æ—Ç–µ–∫–∏), –∞ —Ç–∞–∫–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ–º–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).
\par –£—Å–ø–µ—à–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–º–ø–ª–µ–∫—Å–∞.
\newpage

% –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
\section*{–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤}
\addcontentsline{toc}{section}{–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤}
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–æ–¥–∏–ª–∏—Å—å –Ω–∞ –ü–ö —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

\par –í —Ä–∞–º–∫–∞—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –±—ã–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ (–∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞) –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —É–º–Ω–æ–∂–µ–Ω–∏—è –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü A –∏ B. –†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç [500; 2500] —Å —à–∞–≥–æ–º 500. –≠–ª–µ–º–µ–Ω—Ç–∞–º–∏ –º–∞—Ç—Ä–∏—Ü —è–≤–ª—è—é—Ç—Å—è –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —á–∏—Å–ª–∞ —Ç–∏–ø–∞ double. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –Ω–∞ 4, 9 –∏ 49 –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö. –í—Ä–µ–º—è –≤—ã—Ä–∞–∂–µ–Ω–æ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö. –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ: \begin{equation} –£—Å–∫–æ—Ä–µ–Ω–∏–µ = –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ / –≤—Ä–µ–º—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ \end{equation} 

\begin{itemize}
	\item –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä: Intel Core 5-7400, 3000 MHz, —è–¥–µ—Ä: 4;
	\item –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å: 8192 –ú–ë (DDR4), 2400 MHz;
	\item –û–°: Microsoft Windows 10 Home, –≤–µ—Ä—Å–∏—è 1909 —Å–±–æ—Ä–∫–∞ 18363.1198.
\end{itemize}

\par –î–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏–ª–∞—Å—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–µ–∫—Ç–æ—Ä–æ–≤ —Ä–∞–∑–º–µ—Ä–æ–º \verb|20 000 000| –∑–Ω–∞—á–µ–Ω–∏–π –∫–∞–∂–¥—ã–π. 
\par –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –≤ –¢–∞–±–ª–∏—Ü–µ 1.

\begin{table}[!h]
	\caption{–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤}
	\centering
	\begin{tabular}{lllll}
		–†–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü & –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ & –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ & –£—Å–∫–æ—Ä–µ–Ω–∏–µ \\
		500             & 0.637         & 0.236     & 2.699       \\
		1000            & 8.132         & 3.707     & 2.194       \\
		1500            & 23.189        & 12.065    & 2.0194      \\
		2000            & 62.404        & 32.366    & 1.928       \\
		2500            & 159.031       & 72.379    & 1.928       \\
	\end{tabular}
\end{table}

\par –ü–æ –¥–∞–Ω–Ω—ã–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –≤–∏–¥–Ω–æ, —á—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü. –ù–∞–∏–±–æ–ª—å—à–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–º —Ä–∞–∑–º–µ—Ä–µ –º–∞—Ç—Ä–∏—Ü - —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 1000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
\par –¢–∞–∫–∂–µ –∑–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –º–∞—Ç—Ä–∏—Ü –∏ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä—è–º–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –¥—Ä—É–≥ –¥—Ä—É–≥—É, –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–∞–∏–ª—É—á—à–µ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –¢–∞–∫, –∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞ —É—Å–∫–æ—Ä–µ–Ω–∏—è –≤–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–∏ –º–∞–ª–æ–º —Ä–∞–∑–º–µ—Ä–µ –º–∞—Ç—Ä–∏—Ü 49 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –¥–∞—é—Ç –Ω–∏–∑–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–∑-–∑–∞ –±–æ–ª—å—à–∏—Ö –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–µ–π, –≤–æ–∑–Ω–∏–∫–∞—é—â–∏—Ö –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. –í —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–º–Ω–æ–∂–µ–Ω–∏—è –±–ª–æ–∫–æ–≤ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –±—ã—Å—Ç—Ä–æ. 
\par –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥: —á–µ–º –º–µ–Ω—å—à–µ –º–∞—Ç—Ä–∏—Ü–∞, —Ç–µ–º –º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –ò –Ω–∞–æ–±–æ—Ä–æ—Ç, —á–µ–º –±–æ–ª—å—à–µ –º–∞—Ç—Ä–∏—Ü–∞, —Ç–µ–º –±–æ–ª—å—à–µ–µ —á–∏—Å–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è.
\newpage

% –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
\section*{–ó–∞–∫–ª—é—á–µ–Ω–∏–µ}
\addcontentsline{toc}{section}{–ó–∞–∫–ª—é—á–µ–Ω–∏–µ}
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, —Ä–µ–∞–ª–∏–∑—É—é—â–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –º–∞—Ç—Ä–∏—á–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è ‚Äì –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é MPI.
\par –î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∏ –¥–æ–≤–µ–¥–µ–Ω –¥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –º–æ–¥—É–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Google C++ Testing Framework.
\par –ü–æ –¥–∞–Ω–Ω—ã–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —É–¥–∞–ª–æ—Å—å —Å—Ä–∞–≤–Ω–∏—Ç—å –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —É–º–Ω–æ–∂–µ–Ω–∏—è –º–∞—Ç—Ä–∏—Ü. –í—ã—è–≤–ª–µ–Ω–æ, —á—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –§–æ–∫—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–æ–º –æ–±—ä–µ–º–µ –¥–∞–Ω–Ω—ã—Ö. –ò —á–∏—Å–ª–æ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —É–∑–ª–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä—è–º–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ä–∞–∑–º–µ—Ä—É –º–∞—Ç—Ä–∏—Ü, —É—á–∞—Å—Ç–≤—É—é—â–∏—Ö –≤ —É–º–Ω–æ–∂–µ–Ω–∏–∏. 
\newpage

% –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
\begin{thebibliography}{1}
	\addcontentsline{toc}{section}{–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã}
	\bibitem{Sidnev} –°–∏–¥–Ω–µ–≤ –ê.–ê., –°—ã—Å–æ–µ–≤ –ê.–í., –ú–µ–µ—Ä–æ–≤ –ò.–ë ¬´–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ7. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä—É–¥–æ–µ–º–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –º–æ–¥—É–ª—è –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Intel Xeon Phi. –õ–∏–Ω–µ–π–Ω—ã–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏¬ª. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥, 2007, 56 —Å. 
	\bibitem{parallel} Parallel: –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ù–ò–í–¶ –ú–ì–£ [–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å] // URL: \url {https://parallel.ru/vvv/mpi.html} (–¥–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è: 28.11.2020)
	\bibitem{Algolist} Algolist: –ê–ª–≥–æ—Ä–∏—Ç–º—ã, –º–µ—Ç–æ–¥—ã, –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ [–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å] // URL: \url {http://algolist.manual.ru/sort/radix_sort.php} (–¥–∞—Ç–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è: 28.11.2020)
\end{thebibliography}
\newpage

% –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
\section*{–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ}
\addcontentsline{toc}{section}{–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ}
–í –¥–∞–Ω–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏—Å—Ç–∏–Ω–≥ –≤—Å–µ–≥–æ –∫–æ–¥–∞, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –≤ —Ä–∞–º–∫–∞—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
\begin{lstlisting}
// fox.h
// Copyright 2020 Ikromov Inom

#ifndef MODULES_TASK_3_IKROMOV_I_FOX_FOX_H_
#define MODULES_TASK_3_IKROMOV_I_FOX_FOX_H_

void Fox(double* A, double* B, double* C, int size);
void SequentialAlgorithm(double* A, double* B, double* C, int size);
void RandomOperandMatrix(double* A, double* B, int size);

#endif  // MODULES_TASK_3_IKROMOV_I_FOX_FOX_H_
\end{lstlisting}

\begin{lstlisting}
// fox.cpp
// Copyright 2020 Ikromov Inom

#include <mpi.h>
#include <cmath>
#include <ctime>
#include <random>
#include <stdexcept>
#include "../../../modules/task_3/ikromov_i_fox/fox.h"

#define ndims 2
#define reoder true

int procNum;
int rank;
int cartSize;
int blockSize;
MPI_Comm comm_cart;
MPI_Comm comm_row;
MPI_Comm comm_col;
int coords[2];

void ImportResult(double* C, double* Cblock, int size) {
double* rowbuff = new double[size * blockSize];
for (int i = 0; i < blockSize; i++) {
MPI_Gather(&Cblock[i * blockSize], blockSize, MPI_DOUBLE,
&rowbuff[i * size], blockSize, MPI_DOUBLE, 0, comm_row);
}
if (coords[1] == 0) {
MPI_Gather(rowbuff, blockSize * size, MPI_DOUBLE, C, blockSize * size,
MPI_DOUBLE, 0, comm_col);
}
delete[] rowbuff;
}

void Scatter(double* Matrix, double* block, int size) {
double* rowbuff = new double[blockSize * size];
if (coords[1] == 0) {
MPI_Scatter(Matrix, blockSize * size, MPI_DOUBLE, rowbuff, blockSize * size,
MPI_DOUBLE, 0, comm_col);
}
for (int i = 0; i < blockSize; i++) {
MPI_Scatter(&rowbuff[i * size], blockSize, MPI_DOUBLE,
&(block[i * blockSize]), blockSize, MPI_DOUBLE, 0, comm_row);
}
delete[] rowbuff;
}

void BlockExport(double* A, double* B, double* AMatrixblock, double* Bblock,
int size) {
Scatter(A, AMatrixblock, size);
Scatter(B, Bblock, size);
}

void ABlockTransfer(int it, double* Ablock, double* AMatrixblock) {
int main = (coords[0] + it) % cartSize;
if (coords[1] == main) {
for (int i = 0; i < blockSize * blockSize; ++i) Ablock[i] = AMatrixblock[i];
}
MPI_Bcast(Ablock, blockSize * blockSize, MPI_DOUBLE, main, comm_row);
}

void BlockMultiplication(double* Ablock, double* Bblock, double* Cblock,
int _blockSize) {
double temp;
for (int i = 0; i < _blockSize; i++)
for (int j = 0; j < _blockSize; j++) {
temp = 0;
for (int k = 0; k < _blockSize; k++)
temp += Ablock[i * _blockSize + k] * Bblock[k * _blockSize + j];
Cblock[i * _blockSize + j] += temp;
}
}

void BblockTransfer(double* Bblock) {
MPI_Status status;
int dest = coords[0] - 1;
if (coords[0] == 0) dest = cartSize - 1;
int source = coords[0] + 1;
if (coords[0] == cartSize - 1) source = 0;
MPI_Sendrecv_replace(Bblock, blockSize * blockSize, MPI_DOUBLE, dest, 0,
source, 0, comm_col, &status);
}

void FoxAlg(double* Ablock, double* AMatrixblock, double* Bblock,
double* Cblock) {
for (int it = 0; it < cartSize; ++it) {
ABlockTransfer(it, Ablock, AMatrixblock);
BlockMultiplication(Ablock, Bblock, Cblock, blockSize);
BblockTransfer(Bblock);
}
}

void Topology() {
int dimSize[2] = { cartSize, cartSize };
int periods[2] = { false, false };
MPI_Cart_create(MPI_COMM_WORLD, ndims, dimSize, periods, reoder, &comm_cart);
MPI_Cart_coords(comm_cart, rank, ndims, coords);

int subdims[2];
subdims[0] = false;
subdims[1] = true;
MPI_Cart_sub(comm_cart, subdims, &comm_row);

subdims[0] = true;
subdims[1] = false;
MPI_Cart_sub(comm_cart, subdims, &comm_col);
}

void Fox(double* A, double* B, double* C, int size) {
if (size <= 0) throw std::runtime_error("Wrong size matrix");

MPI_Comm_size(MPI_COMM_WORLD, &procNum);
MPI_Comm_rank(MPI_COMM_WORLD, &rank);

if (procNum == 1) {
SequentialAlgorithm(A, B, C, size);
} else {
cartSize = static_cast<int>(std::sqrt(procNum));
if (cartSize * cartSize != procNum)
throw std::runtime_error("Wrong number of processes");
if (size % cartSize != 0) throw std::runtime_error("Wrong size matrix");
blockSize = size / cartSize;

int numElemBlock = blockSize * blockSize;
double* Ablock = new double[numElemBlock];
double* Bblock = new double[numElemBlock];
double* Cblock = new double[numElemBlock];
double* AMatrixblock = new double[numElemBlock];
for (int i = 0; i < numElemBlock; i++) Cblock[i] = 0;

Topology();

BlockExport(A, B, AMatrixblock, Bblock, size);

FoxAlg(Ablock, AMatrixblock, Bblock, Cblock);

ImportResult(C, Cblock, size);

delete[] Ablock;
delete[] Bblock;
delete[] Cblock;
delete[] AMatrixblock;
}
}

void SequentialAlgorithm(double* A, double* B, double* C, int size) {
if (size <= 0) throw std::runtime_error("Wrong size matrix");
for (int i = 0; i < size * size; ++i) C[i] = 0;
BlockMultiplication(A, B, C, size);
}

void RandomOperandMatrix(double* A, double* B, int size) {
std::mt19937 gen;
gen.seed(static_cast<unsigned int>(time(0)));
for (int i = 0; i < size * size; ++i) {
A[i] = gen() % 5 + static_cast<float>(gen() % 10) / 10;
B[i] = gen() % 5 + static_cast<float>(gen() % 10) / 10;
}
}
\end{lstlisting}
\begin{lstlisting}
// main.cpp
// Copyright 2020 Ikromov Inom

#include <gtest-mpi-listener.hpp>
#include <gtest/gtest.h>
#include <cmath>
#include "../../../modules/task_3/ikromov_i_fox/fox.h"

TEST(Fox, Test_on_Matrix_size_4) {
int size = 4;
double tmp;
double* A = &tmp;
double* B = &tmp;
double* C = &tmp;
double* CFox = &tmp;
int rank, procNum;
MPI_Comm_rank(MPI_COMM_WORLD, &rank);
MPI_Comm_size(MPI_COMM_WORLD, &procNum);

int cartSize = static_cast<int>(std::sqrt(procNum));
if (cartSize * cartSize == procNum && size % cartSize == 0) {
if (rank == 0) {
A = new double[size * size];
B = new double[size * size];
RandomOperandMatrix(A, B, size);
C = new double[size * size];
CFox = new double[size * size];
SequentialAlgorithm(A, B, C, size);
}
Fox(A, B, CFox, size);

if (rank == 0) {
for (int i = 0; i < size * size; ++i) ASSERT_NEAR(CFox[i], C[i], 0.0001);
}

if (rank == 0) {
delete[] A;
delete[] B;
delete[] C;
delete[] CFox;
}
}
}

TEST(Fox, Test_on_Matrix_size_16) {
int size = 16;
double tmp;
double* A = &tmp;
double* B = &tmp;
double* C = &tmp;
double* CFox = &tmp;
int rank, procNum;
MPI_Comm_rank(MPI_COMM_WORLD, &rank);
MPI_Comm_size(MPI_COMM_WORLD, &procNum);

int cartSize = static_cast<int>(std::sqrt(procNum));
if (cartSize * cartSize == procNum && size % cartSize == 0) {
if (rank == 0) {
A = new double[size * size];
B = new double[size * size];
RandomOperandMatrix(A, B, size);
C = new double[size * size];
CFox = new double[size * size];
SequentialAlgorithm(A, B, C, size);
}
Fox(A, B, CFox, size);

if (rank == 0) {
for (int i = 0; i < size * size; ++i) ASSERT_NEAR(CFox[i], C[i], 0.0001);
}

if (rank == 0) {
delete[] A;
delete[] B;
delete[] C;
delete[] CFox;
}
}
}

TEST(Fox, Test_on_Matrix_size_64) {
int size = 64;
double temp;
double* A = &temp;
double* B = &temp;
double* C = &temp;
double* CFox = &temp;
int rank, procNum;
MPI_Comm_rank(MPI_COMM_WORLD, &rank);
MPI_Comm_size(MPI_COMM_WORLD, &procNum);

int cartSize = static_cast<int>(std::sqrt(procNum));
if (cartSize * cartSize == procNum && size % cartSize == 0) {
if (rank == 0) {
A = new double[size * size];
B = new double[size * size];
RandomOperandMatrix(A, B, size);
C = new double[size * size];
CFox = new double[size * size];
SequentialAlgorithm(A, B, C, size);
}
Fox(A, B, CFox, size);

if (rank == 0) {
for (int i = 0; i < size * size; ++i) ASSERT_NEAR(CFox[i], C[i], 0.0001);
}

if (rank == 0) {
delete[] A;
delete[] B;
delete[] C;
delete[] CFox;
}
}
}

TEST(Fox, Throw_Matrix_size_0) {
int size = 0;
double tmp;
double* M = &tmp;
ASSERT_ANY_THROW(Fox(M, M, M, size));
ASSERT_ANY_THROW(SequentialAlgorithm(M, M, M, size));
}

TEST(Fox, Throw_Matrix_size_11) {
int size = 13;
double tmp;
double* M = &tmp;
int procNum;
MPI_Comm_size(MPI_COMM_WORLD, &procNum);

if (procNum > 1) {
ASSERT_ANY_THROW(Fox(M, M, M, size));
}
}

int main(int argc, char** argv) {
::testing::InitGoogleTest(&argc, argv);
MPI_Init(&argc, &argv);

::testing::AddGlobalTestEnvironment(new GTestMPIListener::MPIEnvironment);
::testing::TestEventListeners& listeners =
::testing::UnitTest::GetInstance()->listeners();

listeners.Release(listeners.default_result_printer());
listeners.Release(listeners.default_xml_generator());

listeners.Append(new GTestMPIListener::MPIMinimalistPrinter);
return RUN_ALL_TESTS();
}
listeners.Append(new GTestMPIListener::MPIMinimalistPrinter);
return RUN_ALL_TESTS();
}
\end{lstlisting}

\end{document}

